var fluid=fluid||{};(function(jQuery,fluid){fluid.keys={TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:19,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,i:73,j:74,k:75,m:77};fluid.roles={GRID:{container:"grid",item:"gridcell"},LIST:{container:"list",item:"listitem"},REGIONS:{container:"main",item:"article"}};fluid.orientation={HORIZONTAL:"horiz",VERTICAL:"vert"};fluid.position={BEFORE:0,AFTER:1,INSIDE:2,USE_LAST_KNOWN:3,DISALLOWED:-1};fluid.direction={NEXT:1,PREVIOUS:-1};fluid.defaultKeysets=[{modifier:function(evt){return evt.ctrlKey},up:fluid.keys.UP,down:fluid.keys.DOWN,right:fluid.keys.RIGHT,left:fluid.keys.LEFT},{modifier:function(evt){return evt.ctrlKey},up:fluid.keys.i,down:fluid.keys.m,right:fluid.keys.k,left:fluid.keys.j}];fluid.wrap=function(obj){return((!obj||obj.jquery)?obj:jQuery(obj))};fluid.unwrap=function(obj){return obj.jquery?obj[0]:obj};fluid.container=function(container){if(typeof container==="string"||container.nodeType&&(container.nodeType===1||container.nodeType===9)){container=jQuery(container)}if(!container||!container.jquery||container.length!==1){fluid.fail({name:"NotOne",message:"A single container element was not found."})}return container};var defaultsStore={};fluid.defaults=function(componentName,defaultsObject){if(arguments.length>1){defaultsStore[componentName]=defaultsObject;return defaultsObject}return defaultsStore[componentName]};fluid.dumpEl=function(element){if(!element){return"null"}element=jQuery(element);var togo=element.get(0).tagName;if(element.attr("id")){togo+="#"+element.attr("id")}if(element.attr("class")){togo+="."+element.attr("class")}return togo};fluid.fail=function(message){fluid.utils.setLogging(true);fluid.utils.debug(message.message?message.message:message);message.fail()};function getNextNode(iterator){if(iterator.node.firstChild){iterator.node=iterator.node.firstChild;iterator.depth+=1;return iterator}while(iterator.node){if(iterator.node.nextSibling){iterator.node=iterator.node.nextSibling;return iterator}iterator.node=iterator.node.parentNode;iterator.depth-=1}return iterator}fluid.DOM_BAIL_DEPTH=256;fluid.iterateDom=function(node,acceptor){var currentNode={node:node,depth:0};while(currentNode.node!==null&&currentNode.depth>=0&&currentNode.depth<fluid.DOM_BAIL_DEPTH){if(currentNode.nodeType===1){acceptor(currentNode.node,currentNode.depth)}currentNode=getNextNode(currentNode)}};fluid.createDomBinder=function(container,selectors){var cache={},that={};function cacheKey(name,thisContainer){return jQuery.data(fluid.unwrap(thisContainer))+"-"+name}function record(name,thisContainer,result){cache[cacheKey(name,thisContainer)]=result}that.locate=function(name,localContainer){var selector,thisContainer,togo;selector=selectors[name];thisContainer=localContainer?localContainer:container;if(!thisContainer){fluid.fail("DOM binder invoked for selector "+name+" without container")}if(!selector){return thisContainer}if(typeof (selector)==="function"){togo=jQuery(selector.call(null,fluid.unwrap(thisContainer)))}else{togo=jQuery(selector,thisContainer)}if(togo.get(0)===document){togo=[]}record(name,thisContainer,togo);return togo};that.fastLocate=function(name,localContainer){var thisContainer=localContainer?localContainer:container;var key=cacheKey(name,thisContainer);var togo=cache[key];return togo?togo:that.locate(name,localContainer)};that.clear=function(){cache={}};that.refresh=function(names,localContainer){if(typeof names==="string"){names=[names]}if(!(localContainer instanceof Array)){localContainer=[localContainer]}for(var i=0;i<names.length;++i){for(var j=0;j<localContainer.length;++j){that.locate(names[i],localContainer[j])}}};return that};fluid.mergeComponentOptions=function(that,componentName,userOptions){var defaults=fluid.defaults(componentName);that.options=fluid.utils.merge(defaults?defaults.mergePolicy:null,{},defaults,userOptions)};fluid.initView=function(componentName,container,userOptions){var that={};fluid.mergeComponentOptions(that,componentName,userOptions);if(container){that.container=fluid.container(container);fluid.initDomBinder(that)}return that};fluid.initDomBinder=function(that){that.dom=fluid.createDomBinder(that.container,that.options.selectors);that.locate=that.dom.locate};fluid.initDecorators=function(that){var decorators=that.options.componentDecorators;if(!decorators){return }if(typeof (decorators)==="string"){decorators=[decorators]}for(var i=0;i<decorators.length;i+=1){var decoratorName=decorators[i];fluid.utils.invokeGlobalFunction(decoratorName,[that,that.options[decoratorName]])}};var fluid_guid=1;var fluid_sourceElements={};fluid.event={};fluid.event.getEventFirer=function(){var log=fluid.utils.debug;var listeners={};return{addListener:function(listener,namespace,exclusions){if(!namespace){if(!listener.$$guid){listener.$$guid=fluid_guid+=1}namespace=listener.$$guid}var excludeids=[];if(exclusions){for(var i in exclusions){excludeids.push(jQuery.data(exclusions[i]))}}listeners[namespace]={listener:listener,exclusions:excludeids}},removeListener:function(listener){if(typeof (listener)==="string"){delete listeners[listener]}else{if(typeof (listener)==="object"&&listener.$$guid){delete listeners[listener.$$guid]}}},fireEvent:function(){for(var i in listeners){var lisrec=listeners[i];var excluded=false;for(var j in lisrec.exclusions){var exclusion=lisrec.exclusions[j];log("Checking exclusion for "+exclusion);if(fluid_sourceElements[exclusion]){log("Excluded");excluded=true;break}}if(!excluded){try{log("Firing to listener "+i+" with arguments "+arguments);lisrec.listener.apply(null,arguments)}catch(e){log("FireEvent received exception "+e.message+" e "+e+" firing to listener "+i);throw (e)}}}}}};fluid.model={};fluid.model.copyModel=function copyModel(target,source){fluid.utils.clear(target);jQuery.extend(true,target,source)};fluid.model.parseEL=function(EL){return EL.split(".")};fluid.model.setBeanValue=function(root,EL,newValue){var segs=fluid.model.parseEL(EL);for(var i=0;i<segs.length-1;i+=1){if(!root[segs[i]]){root[segs[i]]={}}root=root[segs[i]]}root[segs[segs.length-1]]=newValue};fluid.model.getBeanValue=function(root,EL){var segs=fluid.model.parseEL(EL);for(var i=0;i<segs.length;i+=1){root=root[segs[i]];if(!root){return root}}return root};fluid.utils={};fluid.utils.computeAbsolutePosition=function(element){var curleft=0,curtop=0;if(element.offsetParent){do{curleft+=element.offsetLeft;curtop+=element.offsetTop}while(element=element.offsetParent);return[curleft,curtop]}};fluid.utils.computeDomDepth=function(element){var depth=0;while(element){element=element.parentNode;depth+=1}return depth};fluid.utils.mousePosition=function(droppableEl,orientation,x,y){var mid;var isBefore;if(orientation===fluid.orientation.VERTICAL){mid=jQuery(droppableEl).offset().top+(droppableEl.offsetHeight/2);isBefore=y<mid}else{mid=jQuery(droppableEl).offset().left+(droppableEl.offsetWidth/2);isBefore=x<mid}return(isBefore?fluid.position.BEFORE:fluid.position.AFTER)};fluid.utils.seekNodesById=function(rootnode,tagname,idmatch){var inputs=rootnode.getElementsByTagName(tagname);var togo=[];for(var i=0;i<inputs.length;i+=1){var input=inputs[i];var id=input.id;if(id&&id.match(idmatch)){togo.push(input)}}return togo};fluid.utils.escapeSelector=function(id){return id.replace(/\:/g,"\\:")};fluid.utils.findForm=function(element){while(element){if(element.nodeName.toLowerCase()==="form"){return element}element=element.parentNode}};fluid.utils.clear=function(target){if(target instanceof Array){target.length=0}else{for(var i in target){delete target[i]}}};function mergeImpl(policy,basePath,target,source){var thisPolicy=policy?policy[basePath]:policy;if(typeof (thisPolicy)==="function"){thisPolicy.apply(null,target,source);return target}if(thisPolicy==="replace"){fluid.utils.clear(target)}for(var name in source){var path=(basePath?basePath+".":"")+name;var thisTarget=target[name];var thisSource=source[name];if(thisSource!==undefined){if(thisSource!==null&&typeof (thisSource)==="object"){if(!thisTarget){target[name]=thisTarget=thisSource instanceof Array?[]:{}}mergeImpl(policy,path,thisTarget,thisSource)}else{target[name]=thisSource}}}return target}fluid.utils.permute=function(){};fluid.utils.merge=function(policy,target){var path="";for(var i=2;i<arguments.length;i+=1){var source=arguments[i];mergeImpl(policy,path,target,source)}if(policy){for(var key in policy){var elrh=policy[key];if(typeof (elrh)==="string"&&elrh!=="replace"){var oldValue=fluid.model.getBeanValue(target,key);if(oldValue===null||oldValue===undefined){var value=fluid.model.getBeanValue(target,elrh);fluid.model.setBeanValue(target,key,value)}}}}return target};fluid.utils.invokeGlobalFunction=function(functionPath,args){return fluid.model.getBeanValue(window,functionPath).apply(null,args)};fluid.utils.jById=function(id){var el=jQuery("[id="+id+"]");if(el[0]&&el[0].id===id){return el}return null};var fluid_logging=false;fluid.utils.debug=function(str){if(fluid_logging){str=new Date().toTimeString()+":  "+str;if(typeof (console)!=="undefined"){if(console.debug){console.debug(str)}else{console.log(str)}}else{if(typeof (YAHOO)!=="undefined"){YAHOO.log(str)}else{if(typeof (opera)!=="undefined"){opera.postError(str)}}}}};fluid.log=fluid.utils.debug;fluid.utils.setLogging=function(enabled){if(typeof enabled==="boolean"){fluid_logging=enabled}else{fluid_logging=false}};fluid.utils.derivePercent=function(num,total){return Math.round((num*100)/total)};fluid.utils.stringTemplate=function(template,values){var newString=template;for(var key in values){if(values.hasOwnProperty(key)){var searchStr="%"+key;newString=newString.replace(searchStr,values[key])}}return newString};fluid.utils.findAncestor=function(element,test){return test(element)?element:jQuery.grep(jQuery(element).parents(),test)[0]}})(jQuery,fluid);